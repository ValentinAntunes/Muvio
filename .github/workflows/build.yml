name: Build Muvio App

on:
  workflow_dispatch:    # permite rodar manualmente
  push:
    tags:
      - 'v*'            # roda quando vocÃª criar tag tipo v1.0, v1.1

jobs:
  build-windows:
    name: Build Windows EXE
    runs-on: windows-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Install Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install pyinstaller yt-dlp PyQt6

      - name: Build EXE
        run: |
          pyinstaller --windowed --onefile ^
            --icon="icon.ico" ^
            --add-data "logo.png;." ^
            --add-binary "ffmpeg.exe;." ^
            --name "Muvio" ^
            app.py

      - name: Upload Windows EXE
        uses: actions/upload-artifact@v3
        with:
          name: muvio-windows
          path: dist/Muvio.exe

  build-macos:
    name: Build macOS APP
    runs-on: macos-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Install Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install pyinstaller yt-dlp PyQt6

      - name: Make ffmpeg executable
        run: chmod +x ffmpeg

      - name: Build macOS App
        run: |
          pyinstaller --windowed \
            --icon="icon.icns" \
            --add-data "logo.png:." \
            --add-binary "ffmpeg:." \
            --name "Muvio" \
            app.py

      - name: Upload macOS APP
        uses: actions/upload-artifact@v3
        with:
          name: muvio-macos
          path: dist/Muvio.app
